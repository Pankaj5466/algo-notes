\documentclass[oneside]{tufte-book}

\usepackage{graphicx} % Required for inserting images


% \newgeometry{inner=20mm,
%             outer=60mm,% = marginparsep + marginparwidth 
%                        %   + 5mm (between marginpar and page border)
%             top=20mm,
%             bottom=25mm,
%             marginparsep=5mm,
%             marginparwidth=50mm,
%             showframe
%             % showframe% for show your page design, normaly not used
%             }

% \RequirePackage{geometry}
% \geometry{includeall, top=14mm, bottom=14mm, inner=20mm, outer=60mm, headheight=16pt, marginparwidth=50mm, marginparsep=5mm}
\setlength{\marginparwidth}{50mm}

\usepackage{multicol}
\usepackage{lipsum}

\newcommand{\tab}{\hspace{8mm}}
% Please ensure there is no binding offset
\usepackage{parskip} %TO-DO: check why its effect not effecing in global, only affected within environment when used like as shown in \begin{guide}

% \usepackage{marginnote}
\usepackage{layout}
\usepackage{lipsum}
\usepackage{blindtext}
\usepackage{tikz}
\usepackage{listings}
\usepackage{paracol}
\usepackage{amsmath} 
\usepackage{import}
% \usepackage{enumitem}
% \usepackage{paralist}
% amsmath have \text{}

% for color
\usepackage{xcolor}
\usepackage{soul}
\usepackage{paralist}

% Environment Here
\usepackage{mdframed}
\usepackage{xcolor}
\usepackage{fancyvrb}
\usepackage{needspace}
\usepackage{environ}
\usepackage{fontawesome5}

\newcommand{\rfl}[1]{ \sethlcolor{yellow}\hl{#1}} %rfl = remember for later
\newcommand{\intution}[1]{\sethlcolor{green!40}\hl{#1}} 
\newcommand{\constrain}[1]{\hfill\begin{math} #1 \end{math}}


% \newenvironment{exercise}[1][Chapter Exercises:]
% {
%     \begin{fullwidth}
%     \begin{multicols}{2}
% }
% {
%     \end{multicols}
%     \end{fullwidth}
% }


% \newenvironment{foo}[2]
%   {something with #1 and #2 to be performed at the beginning}
%   {something to be performed at the end}

%   \begin{foo}{arg1}{arg2}
%     some stuff in the middle
%     \end{foo}

\newenvironment{problem}[2][Q:]
    { \newpage \begin{mdframed}[backgroundcolor=yellow!40] \addcontentsline{toc}{section}{#2} \textbf{#1 #2} \\}
    {  \end{mdframed}}
 
    % \setlength\parindent{0pt}
% Define solution environment
%guide: \newenvironment{name}[num]{before code}{after code}
\newenvironment{solution}[1][]
    { \addcontentsline{toc}{subsection}{#1} \setlength\parindent{0pt} \vspace{4mm} \noindent\textit{Solution:  \hfill #1 } \\[2mm]\parskip=.6em}
    {\hfill \\ \rule{\textwidth}{1pt}}


\newenvironment{guide}
{
  \textcolor{green}{\rule{\textwidth}{2pt}} \textbf{Hints:}\newline \parskip=.6em
  \renewcommand{\item}{\vspace{.7em}\faHandPointRight\hspace{2mm}} %VERT IMPORTANT: defining command within environment scope
}
{\par\textcolor{green}{\rule{\textwidth}{2pt}}\par}


\newcommand{\texthighlight}[2]
{\sethlcolor{#1}{\hl{#2}}}
%hl stands for highlight

% \newenvironment{intution}
%     {\par\smallskip\noindent\underline{Intution:}\quad}
%     {}

% Environment end here

%------------------------------------------------------------
% VARIOUS RULERS, SEPARATORS & DIVIDERS
%------------------------------------------------------------
\newcommand{\rulethick}[1][darkgray]{\par\textcolor{#1}{\rule{\linewidth}{4pt}}\par}
\newcommand{\rulethin}[1][black]{\par\textcolor{#1}{\rule{\linewidth}{1pt}}\par}

\usepackage{multicol}
% \RequirePackage[twosidemode, needspace=3mm, outermargin=-\marginparsep-\marginparwidth]{fullwidth}

% % TUFLE BASES FULL WIDTH ENVIRONMENT
% % (WILL NOT WORKING with twoside page]
\newlength{\fullwidthlen}
\setlength{\fullwidthlen}{\marginparwidth}
\addtolength{\fullwidthlen}{\marginparsep}

% \newenvironment{fullwidth}[1][]{%
%   \begin{adjustwidth*}{}{-\fullwidthlen}%
% }{%
%   \end{adjustwidth*}%
% }

\newenvironment{pratice}
{  
    \begin{fullwidth}
    
    \begin{mdframed}[leftline=true, rightline=true,linewidth=2pt,linecolor=gray] %hidealllines=true add it to default do show any border
    \begin{center}
    \addcontentsline{toc}{subsection}{Pratice More Problems}
    {\Large Pratice Problems:}
    % TO-DO: Increase the font-size of above text to make it stand out from the content.
}
{\end{center}\end{mdframed}\end{fullwidth}}

\newenvironment{praticeHints}
{  
    \begin{fullwidth}
    
    \begin{mdframed}[leftline=true, rightline=true,linewidth=2pt,linecolor=green!40]
    \begin{center}
    {\Large Pratice Problems Hints:}
}
{\end{center}\end{mdframed}\end{fullwidth}}




% usage: \begin{problems}[heading]{problems}
\newenvironment{exercise}[1][Chapter Exercises:]{
   
    \begin{fullwidth}
    \rulethick\vspace*{-3mm}
    % \setlist[enumerate,1]{label=\arabic*.}
    % \setlist[myenum,2]{label=\alph*)}
    \section*{#1}
    \addcontentsline{toc}{section}{#1}
    \begin{multicols}{2}
  }{
    \end{multicols}\end{fullwidth}
  }

  \newenvironment{exerciseHints}[1][Exercises Solutions:]{
    \begin{fullwidth}  
    \rulethick[green!40]\vspace*{-3mm}

    \section*{#1}
    \begin{multicols}{2}
  }{
    \end{multicols}\end{fullwidth}
  }

%------------------------------------------------------------
% VARIOUS RULERS, SEPARATORS & DIVIDERS
%------------------------------------------------------------


\usepackage{multicol}
% \RequirePackage[twosidemode, needspace=3mm, outermargin=-\marginparsep-\marginparwidth]{fullwidth}

% Below define code environemnt

\newenvironment{code}
{\Verbatim[samepage=true]}
{\endVerbatim}


% \makeatletter
% \renewcommand{\mdf@prebreakhook}{\newpage}
% \makeatother

\lstset{
  basicstyle=\ttfamily,
  columns=fullflexible,
  keepspaces=true,
  frame=single,
  breaklines=true
}
% use it like \begin{lstlisting} code \end{lstlisting}
% or use it single line as \verb|int val1;|

% use this for normal width with marginparwidth & images on side. \code2{Code Caption}
\lstnewenvironment{code2c}[1][]
{
    % see listing package documentation to learn about below/more options (https://ctan.org/pkg/listings?lang=en)
    \lstset{
        basicstyle=\ttfamily, %verbatium usages ttfamily font, hence setting it this means display be like verbatium
        columns=fullflexible,
        keepspaces=true,
        frame=single, %making is single will draw a border
        framerule=0pt, %frame that is not visible (added to use margin)
        backgroundcolor=\color{gray!10}, %to code background color
        breaklines=true, % for text autowrap around boundary
        % resetmargins=true,
        caption=#1,
      }
}
{}

\lstnewenvironment{code2}[1][]
{
    % see listing package documentation to learn about below/more options (https://ctan.org/pkg/listings?lang=en)
    \lstset{
        basicstyle=\ttfamily, %verbatium usages ttfamily font, hence setting it this means display be like verbatium
        columns=fullflexible,
        keepspaces=true,
        frame=single, %making is single will draw a border
        framerule=0pt, %frame that is not visible (added to use margin)
        % backgroundcolor=\color{gray!10}, %to code background color
        breaklines=true, % for text autowrap around boundary
        % resetmargins=true,
        caption=#1,
      }
}
{}

% IMP: if you want it to on same page, one option is to use \newpage wher you want it (as for now mdframe cannot be used with lstenvironment)
% tested with minipage , mdframe no simple solution found.
% tested with calulcation of content width, but the issue is that code \BODY cannot be expande well.
% tested with codeframe new envrionment, same issue as code body cannot be passed to new envrionemnt

% use this for full width code display
% \lstnewenvironment{code3}[1][]
% {
%     \newgeometry{left=15mm,right=15mm}
%     % see listing package documentation to learn about below/more options
   
%     \lstset{
%         basicstyle=\ttfamily,
%         columns=fullflexible,
%         keepspaces=true,
%         frame=single, %making is single will draw a border
%         framerule=0pt, %frame that is not visible (added to use margin)
%         backgroundcolor=\color{gray!10}, %to code background color
%         breaklines=true, % for text autowrap around boundary
%         resetmargins=true,
%         caption=#1
%       } 
% }
% {\restoregeometry}

% Create a new environment without borders
\newenvironment{mdframed2}{
  \begin{mdframed}[
    hidealllines=true,
    innertopmargin=0pt,
    innerbottommargin=0pt,
    skipabove=0pt,
    skipbelow=0pt,
  ]
}{
  \end{mdframed}
}

\lstnewenvironment{code3}[1][]
{
  % \newgeometry{left=15mm,right=15mm,bottom=2.5cm}
  \lstset{
        basicstyle=\ttfamily,
        columns=fullflexible,
        keepspaces=true,
        frame=single, %making is single will draw a border
        framerule=0pt, %frame that is not visible (added to use margin)
        backgroundcolor=\color{gray!10}, %to code background color
        breaklines=true, % for text autowrap around boundary
        resetmargins=true,
        caption=#1
        } 
}
{}

\lstnewenvironment{code4}[1][]
{
  % \newgeometry{left=15mm,right=15mm,bottom=2.5cm}
  \lstset{
        basicstyle=\ttfamily,
        columns=fullflexible,
        keepspaces=true,
        frame=single, %making is single will draw a border
        framerule=0pt, %frame that is not visible (added to use margin)
        backgroundcolor=\color{gray!10}, %to code background color
        breaklines=true, % for text autowrap around boundary
        resetmargins=true,
        caption=#1
      } 
}
{}


% see listing package documentation for more
\newcommand{\icode}[1]{\lstinline|#1|}
\newenvironment{comment}{}{}

% code environemtn ends here


% \newenvironment{code}
% {\endgraf\noindent 
% \endgraf\verbatim}
% {\endverbatim}

% \settocdepth{section} % For numbering section & subsection
% \setsecnumdepth{subsubsection}
\setcounter{tocdepth}{3}






















\begin{document}

% \newgeometry{left=30mm,right=30mm}

\frontmatter

% Three-level Table of Contents

\tableofcontents

% \restoregeometry%

\mainmatter{}


% \import{./}{dp.tex}
% \import{./stack}{stack.tex}
% % \newpage
\lipsum[1-10]

% \cite{none}
% \layout*

\end{document}